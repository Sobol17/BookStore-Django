<section id="reviews-section" class="rounded-3xl border border-accent-soft/60 bg-white p-6 space-y-6">
  <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
    <div>
      <h2 class="text-2xl font-semibold text-ink">Отзывы о товаре</h2>
      <div class="mt-2 flex items-center gap-3 text-sm text-ink">
        <div class="flex items-center text-amber-500">
          {% for _ in "12345"|make_list %}
            {% if forloop.counter <= reviews_average %}
              <svg class="h-4 w-4 text-amber-500" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                <path d="M10 1.5l2.472 5.012 5.528.804-4 3.898.944 5.506L10 14.77l-4.944 2.95.944-5.506-4-3.898 5.528-.804z" />
              </svg>
            {% else %}
              <svg class="h-4 w-4 text-ink-muted" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                <path d="M10 1.5l2.472 5.012 5.528.804-4 3.898.944 5.506L10 14.77l-4.944 2.95.944-5.506-4-3.898 5.528-.804z" />
              </svg>
            {% endif %}
          {% endfor %}
        </div>
        <span class="font-semibold text-lg">{{ reviews_average_display }}</span>
        <span class="text-ink-muted">{{ reviews_total }} отзыв{{ reviews_total|pluralize:"ов" }}</span>
      </div>
    </div>
    <button
      type="button"
      class="rounded-xl bg-blush px-6 py-3 text-base font-semibold text-white transition hover:bg-accent-dark"
      hx-get="{% url 'main:product_review_create' product.slug %}"
      hx-target="#modal-root"
      hx-swap="innerHTML"
    >
      Оставить отзыв
    </button>
  </div>

  <div class="divide-y divide-accent-soft/50">
    {% if reviews %}
      {% for review in reviews %}
        <article class="py-5 first:pt-0">
          <div class="flex items-start gap-4">
            <div class="flex h-10 w-10 items-center justify-center rounded-full bg-accent-soft text-lg font-semibold text-ink">
              {{ review.author_name|slice:":1"|upper }}
            </div>
            <div class="flex-1 space-y-1">
              <div class="flex flex-wrap items-center gap-2 text-sm text-ink">
                <p class="font-semibold text-base">{{ review.author_name }}</p>
                <span class="text-ink-muted">{{ review.created_at|date:"d.m.Y" }}</span>
              </div>
              <div class="flex items-center text-amber-500">
                {% for star in "12345"|make_list %}
                  {% if forloop.counter <= review.rating %}
                    <svg class="h-4 w-4 text-amber-500" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                      <path d="M10 1.5l2.472 5.012 5.528.804-4 3.898.944 5.506L10 14.77l-4.944 2.95.944-5.506-4-3.898 5.528-.804z" />
                    </svg>
                  {% else %}
                    <svg class="h-4 w-4 text-ink-muted" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                      <path d="M10 1.5l2.472 5.012 5.528.804-4 3.898.944 5.506L10 14.77l-4.944 2.95.944-5.506-4-3.898 5.528-.804z" />
                    </svg>
                  {% endif %}
                {% endfor %}
              </div>
              <p class="text-base text-ink mt-2">{{ review.text|linebreaksbr }}</p>
            </div>
          </div>
        </article>
      {% endfor %}
    {% else %}
      <div class="py-6 text-center text-ink-muted">
        Пока нет отзывов — станьте первым, кто поделится впечатлением.
      </div>
    {% endif %}
  </div>
</section>
